<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <title>Url Shortener</title>
  </head>
  <body>
    <!--https://stackoverflow.com/a/45370541 -->
    <label for="url">Long Url</label>
    <input type="text" id="url" name="url" /><br /><br />
    <!-- <label for="password">Delete Password (optional)</label>
  <input type="text" id="password" name="password"><br><br> !-->
    <button
      id="button"
      type="button"
      value="send"
      onclick="return submitForm()"
    >
      button
    </button>
    <p>hi</p>
    <div id="links-container">
      <ul id="links"></ul>
    </div>

    <script>
      function submitForm(e, form) {
        const url_input = document.getElementById("url").value;

        fetch("/api/url", {
          method: "post",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            url: url_input,
          }),
        })
          .then(function (response) {
            return response.json();
          })
          .then(function (data) {
            //Success code goes here
            console.log(data);
            const li = document.createElement("li");
            li.innerHTML = `<a href="/${data.short_hash}">${location.href}${data.short_hash}</a>`;
            document.querySelector("#links").append(li);
          })
          .catch(function (err) {
            //Failure
            console.log(err);
          });
      }
    </script>
  </body>
</html>
